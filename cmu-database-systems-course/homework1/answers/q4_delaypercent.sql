WITH LateOrderDetails AS (SELECT CompanyName, COUNT(*) as LateOrderCount FROM 'Order' as o JOIN Shipper as s ON o.ShipVia = s.Id WHERE RequiredDate < ShippedDate GROUP BY CompanyName) SELECT lod.CompanyName, round(CAST(lod.LateOrderCount AS REAL) * 100 / CAST(aod.AllOrderCount AS REAL), 2) as percentage FROM LateOrderDetails as lod JOIN (SELECT CompanyName, COUNT(*) as AllOrderCount FROM 'Order' as o JOIN Shipper as s ON o.ShipVia = s.Id GROUP BY CompanyName) as aod ON lod.CompanyName = aod.CompanyName ORDER BY percentage DESC;